//>>built
define("yadaWight/YDLazyTreeMenu",["dijit/Tree","require","dojo/_base/declare","dijit/tree/ForestStoreModel","dojo/data/ItemFileWriteStore","dijit/Menu","dijit/MenuItem","dijit/Dialog","dijit/registry","dojo/on","dojo/_base/event","./YDLazyTree"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,on,_a,_b){var _c=_3([_1._TreeNode],{});return _3("yadaWight.YDLazyTreeMenu",[_b],{persist:false,isRightMenu:false,showDelete:true,showShow:false,rootShowMenu:true,clicktoUrl:null,editJspUrl:null,addJspUrl:null,deleteUrl:null,showUrl:null,editLabel:null,addLabel:null,deleteLabel:null,showLabel:null,click:false,clicktoId:null,createNode:null,treeDialog:null,constructor:function(a){this.isExpandable=false;},postCreate:function(){var _d=this;this.own(on(this.domNode,on.selector(".dijitTreeNode","contextmenu"),function(_e){_d._onContextMenu(_9.byNode(this),_e);}));this.treeDialog=this.newDialog();if(this.isRightMenu){this.newMenu();}this.inherited(arguments);},_onContextMenu:function(_f,e){this.focusNode(_f);_a.stop(e);},onClick:function(_10){if(this.click&&this.clicktoId!=null&&this.clicktoId!=""){if(this.clicktoUrl!=null){dijit.byId(this.clicktoId).setHref(this.clicktoUrl+_10.treeId);}else{throw new Error("请添加点击的url地址");}}this.inherited(arguments);},newMenu:function(){var _11=null;var _12=this;var _13=null;var _14=null;var _15=null;var _16=null;var _17=this.treeDialog;_17.setAttribute("style","width: 800px; height: 350px;");var _18=_6({targetNodeIds:[_12.id],style:{width:"100px"},startup:function(){dojo.connect(this,"_openMyself",_12,function(e){_11=dijit.getEnclosingWidget(e.target);_18.removeChild(_14);_18.removeChild(_15);_18.removeChild(_16);if(_12.showDelete){_18.addChild(_15);}if(_12.showShow){_18.addChild(_16);}if(_11.lastFocused.item.isLeaf=="Y"){_18.addChild(_14);}if(_12.rootShowMenu){_18.addChild(_14);}});}});_13=_7({label:_12.addLabel||"增加菜单",onClick:function(){_12.createNode=_11;_17.setAttribute("title",_12.addLabel||"增加菜单");if(_12.addJspUrl!=null){_17.setAttribute("href",_12.addJspUrl+"&treeId="+_11.lastFocused.item.treeId);}else{throw new Error("请添加引入的url地址");}_17.show();}});_14=_7({label:_12.editLabel||"修改菜单",onClick:function(){_12.createNode=_11;_17.setAttribute("title",_12.editLabel||"修改菜单");if(_12.editJspUrl!=null){_17.setAttribute("href",_12.editJspUrl+"&treeId="+_11.lastFocused.item.treeId);}else{throw new Error("请添加引入的url地址");}_17.show();}});_16=_7({label:_12.showLabel||"查看菜单",onClick:function(){_12.createNode=_11;_17.setAttribute("title",_12.showLabel||"查看菜单");if(_12.showUrl!=null){_17.setAttribute("href",_12.showUrl+"&treeId="+_11.lastFocused.item.treeId);}else{throw new Error("请添加引入的url地址");}_17.show();}});_15=_7({label:_12.deleteLabel||"删除菜单",onClick:function(){_12.deleteNode(_11);}});_18.addChild(_13);_18.startup();},getIsTrueSubmit:function(url,_19){var _1a=false;if(url!=null){dojo.xhrPost({url:url+"&treeId="+_19,sync:true,handle:function(_1b){_1a=_1b;}});}else{throw new Error("请添加删除的url地址");}return _1a;},newDialog:function(){var _1c=_8({preventCache:false,refreshOnShow:true});return _1c;},addTreeNode:function(_1d,_1e,_1f,_20){if(_1d!="false"){var _21={treeId:_1e,treeName:_1f,isLeaf:_20};var _22={parent:this.createNode.lastFocused.item,attribute:"children"};this.model.store.newItem(_21,_22);this.model.store.setValue(this.createNode.lastFocused.item,"isLeaf","N");this.treeDialog.hide();}else{alert("保存失败");}},editTreeNode:function(_23,_24,_25){if(_23!="false"){var _26={treeName:_24,isLeaf:_25};for(var _27 in _26){this.model.store.setValue(this.createNode.lastFocused.item,_27,_26[_27]);}this.treeDialog.hide();}else{alert("修改失败");}},deleteNode:function(_28){if(confirm("是否删除此菜单?")){var _29=this.getIsTrueSubmit(this.deleteUrl,_28.lastFocused.item.treeId);if(_29!="false"){this.model.store.deleteItem(_28.lastFocused.item);}else{alert("删除失败!");}}}});});