//>>built
require({cache:{"url:yadaWight/templates/cbtreeNode.html":"<div class=\"dijitTreeNode\" role=\"presentation\">\n\t<div data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow dijitInline\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"indentNode\" class=\"dijitInline\"></div>\n\t\t<img src=\"${_blankGif}\" alt=\"\" data-dojo-attach-point=\"expandoNode\"class=\"dijitTreeExpando\" role=\"presentation\" />\n\t\t<span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"></span>\n\t\t<span data-dojo-attach-point=\"checkBoxNode\" class=\"cbtreeCheckBox\" role=\"presentation\"></span>\n\t\t<span data-dojo-attach-point=\"contentNode\" class=\"dijitTreeContent\" role=\"presentation\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"/>\n\t\t\t<span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\" tabindex=\"-1\" aria-selected=\"false\"></span>\n\t\t</span>\n\t</div>\n\t<div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\n</div>\n"}});define("yadaWight/cbTreeTest",["dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/_base/lang","dojo/DeferredList","dojo/dom-construct","dojo/text!./templates/cbtreeNode.html","dijit/_Container","dijit/registry","dijit/Tree","dijit/form/CheckBox","cbtree/models/_dndSelector","require","cbtree/models/ForestStoreModel","dojo/data/ItemFileWriteStore","cbtree/Tree"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){var _11=_2([_a._TreeNode],{templateString:_7,moduleName:"cbTree/_TreeNode",_checkBox:null,_toggle:true,_widget:null,constructor:function(_12){var _13={type:_b,target:"INPUT",mixin:null,postCreate:null};var _14={multiState:null,checked:undefined,value:"on"};var _15=_12.widget;if(_15){_4.mixin(_14,_15.args);_4.mixin(_13,_15);}_13.args=_14;this._toggle=_4.isFunction(_13.type.prototype.toggle);this._widget=_13;},_createCheckBox:function(_16){var _17=this.tree.model.getItemState(this.item);var _18=_17.checked;var _19=_17.enabled;var _1a=this._widget;var _1b=_1a.args;if(_18!==undefined){_1b.multiState=_16;_1b.checked=_18;_1b.value=this.label;if(_4.isFunction(_1a.mixin)){_4.hitch(this,_1a.mixin)(_1b);}this._checkBox=new _1a.type(_1b);if(this._checkBox){if(_4.isFunction(this._widget.postCreate)){_4.hitch(this._checkBox,this._widget.postCreate)(this);}_6.place(this._checkBox.domNode,this.checkBoxNode,"replace");}}if(this._checkBox){if(this.isExpandable){if(this.tree.branchReadOnly||!_19){this._checkBox.set("readOnly",true);}}else{if(this.tree.leafReadOnly||!_19){this._checkBox.set("readOnly",true);}}}},_getCheckedAttr:function(){if(this._checkBox){return this.tree.model.getChecked(this.item);}},_set_checked_Attr:function(_1c){if(this._checkBox){this._checkBox.set("checked",_1c);}},_setCheckedAttr:function(_1d){if(this._checkBox){return this.tree.model.setChecked(this.item,_1d);}},_getEnabledAttr:function(){return this.tree.model.getEnabled(this.item);},_set_enabled_Attr:function(_1e){this._checkBox.set("readOnly",!_1e);},_setEnabledAttr:function(_1f){return this.tree.model.setEnabled(this.item,_1f);},_toggleCheckBox:function(){var _20,_21;if(this._checkBox){if(this._toggle){_20=this._checkBox.toggle();}else{_21=this._checkBox.get("checked");_20=(_21=="mixed"?true:!_21);}this.tree.model.setChecked(this.item,_20);}return _20;},destroy:function(){if(this._checkbox){this._checkbox.destroy();delete this._checkbox;}this.inherited(arguments);},postCreate:function(){var _22=this.tree,_23=null,_24;if(_22.checkBoxes===true){this._createCheckBox(_22._multiState);}if(_22._hasStyling&&_22._iconAttr){var _23=_22.get("icon",this.item);if(_23){this.set("_icon_",_23);}}this.set("tooltip",this.title);this.inherited(arguments);},setChildItems:function(_25){var _26=this.tree,_27=_26.model,_28=[];var _29=this.getChildren();_1.forEach(_29,function(_2a){_8.prototype.removeChild.call(this,_2a);},this);this.defer(function(){_1.forEach(_29,function(_2b){if(!_2b._destroyed&&!_2b.getParent()){_26.dndController.removeTreeNode(_2b);var id=_27.getIdentity(_2b.item),ary=_26._itemNodesMap[id];if(ary.length==1){delete _26._itemNodesMap[id];}else{var _2c=_1.indexOf(ary,_2b);if(_2c!=-1){ary.splice(_2c,1);}}_2b.destroyRecursive();}});});this.state="LOADED";if(_25&&_25.length>0){this.isExpandable=true;_1.forEach(_25,function(_2d){var id=_27.getIdentity(_2d),_2e=_26._itemNodesMap[id],_2f;if(_2e){for(var i=0;i<_2e.length;i++){if(!_2e[i]||_2e[i]._beingDestroyed){_2e.splice(i,1);if(_2e.length==0){delete _26._itemNodesMap[id];}}else{if(!_2e[i].getParent()){_2f=_2e[i];_2f.set("indent",this.indent+1);break;}}}}if(!_2f){_2f=this.tree._createTreeNode({item:_2d,tree:_26,isExpandable:_27.mayHaveChildren(_2d),label:_26.getLabel(_2d),tooltip:_26.getTooltip(_2d),ownerDocument:_26.ownerDocument,dir:_26.dir,lang:_26.lang,textDir:_26.textDir,indent:this.indent+1});if(_2e){_2e.push(_2f);}else{_26._itemNodesMap[id]=[_2f];}}this.addChild(_2f);if(this.tree.autoExpand||this.tree._state(_2f)){_28.push(_26._expandNode(_2f));}},this);_1.forEach(this.getChildren(),function(_30){_30._updateLayout();});}else{_26._collapseNode(this);this.isExpandable=false;}if(this._setExpando){this._setExpando(false);}this._updateItemClasses(this.item);if(this==_26.rootNode){var fc=this.tree.showRoot?this:this.getChildren()[0];if(fc){fc.setFocusable(true);_26.lastFocused=fc;}else{_26.domNode.setAttribute("tabIndex","0");}}var def=new _5(_28);this.tree._startPaint(def);return def;}});return _2("dojoJS.cbTreeTest",[_a],{persist:false,checkBoxes:true,_eventAttrMap:null,_checkedAttr:"",_customWidget:null,constructor:function(a){this.model=this.initData(a.url);},initData:function(url){var _31=null;dojo.xhrPost({url:url,sync:true,handle:function(_32){_31=_32;}});var da={"identifier":"treeId","label":"treeName"};da.items=eval("("+_31+")");for(var i=0;i<da.items.length;i++){if(da.items[i].isLeaf=="N"){da.items[i].children=new Array();}}datas=new _f({data:da,getChildren:function(_33){return this.query({parent:_33.treeId});}});var _34=_e({rootLable:"treeName",store:datas,query:{isLeaf:"N"},childrenAttrs:["children"],mayHaveChildren:function(_35){return _35.isLeaf=="N";}});return _34;},onOpen:function(_36){this.addNode(this,"open",_36);},addNode:function(_37,e,_38){var _39=dijit.byId(_37.id);var _3a=false;if(_37.selectedItems!=null){var tn;var a;if(e!="open"){a=_39.getNodesByItem(_37.selectedItems[0])[0];tn=_37.selectedItems[0];}else{var xx=_39.getNodesByItem(_38)[0];tn=xx.item;a=xx;}if(tn.isLeaf!=undefined&&tn.isLeaf!="Y"&&tn.children==""){_3a=true;var _3b;var url=tn.url;var _3c={parent:tn,attribute:"children"};dojo.xhrGet({url:url,sync:true,handle:function(_3d){_3b=eval("("+_3d+")");}});for(var i=0;i<_3b.length;i++){_39.model.store.newItem(_3b[i],_3c);}}if(!_3a){if(e!="open"){if(a.isExpanded){a.collapse();}else{a.expand();}}}else{a.expand();}}},getSelectedCheckBox:function(){var _3e=new Array();var _3f=this.model.store;for(var i=0;i<_3f._arrayOfAllItems.length;i++){var a=_3f._arrayOfAllItems[i].checked;if(a=="true"||a=="mixed"){_3e.push(_3f._arrayOfAllItems[i].treeId);}}return _3e;},createOneHiddenInputForSubmit:function(_40){var _41=new Array();var _42=this.model.store;for(var i=0;i<_42._arrayOfAllItems.length;i++){var a=_42._arrayOfAllItems[i].checked;if(a=="true"||a=="mixed"){_41.push(_42._arrayOfAllItems[i].treeId);}}dojo.create("input",{id:_40,name:_40,type:"hidden"},this.id);dojo.byId(_40).value=_41;return _41;},createAnyHiddenInputForSubmit:function(_43){var _44=new Array();var _45=this.model.store;for(var i=0;i<_45._arrayOfAllItems.length;i++){var a=_45._arrayOfAllItems[i].checked;if(a=="true"||a=="mixed"){var _46=dojo.create("input",{id:_43,name:_43,type:"hidden"},this.id);_46.value=_45._arrayOfAllItems[i].treeId;}}return _44;},_onCheckBoxClick:function(_47,_48,evt){var _49=_47.item;this._publish("checkbox",{item:_49,node:_47,state:_48,evt:evt});this.onCheckBoxClick(_49,_47,evt);this.onClick(_47.item,_47,evt);this.focusNode(_47);_3.stop(evt);},_onClick:function(_4a,evt){var _4b=_4a._widget;if(evt.target.nodeName==_4b.target){var _4c=_4a._checkBox.get("checked");this.model.setChecked(_4a.item,_4c);this._onCheckBoxClick(_4a,_4c,evt);}else{this.inherited(arguments);}},_onLabelChange:function(_4d,_4e){this.mapEventToAttr(_4d,_4e,"label");},postMixInProperties:function(){this._eventAttrMap={};this.inherited(arguments);},postCreate:function(){var _4f=this.model;if(this.model){if(this.checkBoxes===true){if(!this._modelOk()){throw new Error(this.moduleName+"::postCreate(): model does not support getChecked() and/or setChecked().");}this._multiState=_4f.multiState;this._checkedAttr=_4f.checkedAttr;this.mapEventToAttr(null,(this._checkedAttr||"checked"),"_checked_");_4f.validateData();}this.connect(_4f,"onLabelChange","_onLabelChange");this.mapEventToAttr(null,_4f.get("enabledAttr"),"_enabled_");this.mapEventToAttr(null,_4f.get("labelAttr"),"label");this.inherited(arguments);}else{throw new Error(this.moduleName+"::postCreate(): no model was specified.");}},mapEventToAttr:function(_50,_51,_52,_53){if(_4.isString(_51)&&_4.isString(_52)){if(_51.length&&_52.length){if(_50){delete this._eventAttrMap[_50];}this._eventAttrMap[_51]={attribute:_52,value:_53};}}},_modelOk:function(){if((this.model.getChecked&&_4.isFunction(this.model.getChecked))&&(this.model.setChecked&&_4.isFunction(this.model.setChecked))){return true;}return false;},_createTreeNode:function(_54){_54["widget"]=this._customWidget;if(this._hasStyling&&this._icon){_54["icon"]=this._icon;}return new _11(_54);}});_a._TreeNode=_11;});